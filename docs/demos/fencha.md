---
title: 分叉智能前端专家面试
nav:
  title: 模拟试题
  path: /demos
  order: 0
group:
  title: 技术部分
  path: /demos/technology
---

# 分叉智能前端专家面试

- 2022.11.30

## 1.自我介绍

面试官你好，我叫许将龙，今年 28 岁，浙江台州人，计算机相关专业毕业，从事前端相关的工作已经有 6 年。

自工作以来，主要深耕于 PC、H5、公众号、小程序、Hybrid 等方向，业务范围主要囊括了电商、金融、直播、拍卖行等场景，擅长 React 相关的一些技术栈。

之前担任公司业务线内前端团队的 Leader，负责主站核心业务--直播和拍卖行相关的业务开发、团队资源统筹、项目管理以及成员带教相关的工作。期间也带领团队完成了多次核心业务指标贡献，辅导了 4 位成员的转正和晋升工作。

此外我也是一个擅长总结和归纳的人，除了定期在团队内外组件技术分享外，闲暇的时间我也沉淀了上百篇的技术博客。

最后，我是一个外向、乐观、自律的人，擅长与人沟通，学习能力强，能够快速的融入到团队中来。

## 2. 小程序的启动机制

小程序主要有 2 种启动机制：`冷启动` 和 `热启动`。

- 热启动：假如用户在一定时间内打开过小程序，在一定时间内再次打开，那么小程序不会重新启动，会从后台的状态切换到前台。

- 冷启动：指的是用户首次打开，或者是被微信销毁关闭后打开，或者是用户手动将小程序删除后再次打开。

在小程序冷启动的时候，如果发现了有新的代码包，那么会异步下载新版本的代码包并且同时用客户端的代码包进行启动。

新版本的小程序需要等下一次的冷启动才会用上。

当小程序进入后台，长时间未运行的时候启动会是冷启动，大概是 5 分钟。

当短时间内，大概是 5s，连续收到系统内存告警的时候会被微信关闭，提示当前系统内存不足。

必要时可以使用 `wx.onMemoryWarning` 监听内存告警事件。

## 3. 如果想立即使用最新的版本呢？

可以使用`wx.getUpdateManager()`进行检测，不过一般不推荐这样的做法，对业务流程的侵入性比较强。

```js
// app.js
onLaunch(){
  // console.log('是否进入onlanuch');
  this.checkUpdateVersion()
}

// checkUpdateVersion
checkUpdateVersion() {
    const _that = this;
    //判断微信版本是否 兼容小程序更新机制API的使用
    if (wx.canIUse('getUpdateManager')) {
      //创建 UpdateManager 实例
      const updateManager = wx.getUpdateManager();
      console.log('是否进入模拟更新');
      //检测版本更新
      updateManager.onCheckForUpdate(function (res) {
        console.log('是否获取版本');
        if (res.hasUpdate) { // 请求完新版本信息的回调
          updateManager.onUpdateReady(function () { //监听小程序有版本更新事件
            //新的版本已经下载好，调用 applyUpdate 应用新版本并重启 （ 此处进行了自动更新操作）
            wx.showModal({
              title: '更新提示',
              content: '新版本已准备好,是否重启应用?',
              success: (res) => {
                if (res.confirm) {
                  updateManager.applyUpdate();
                }
              }
            })
          })
          updateManager.onUpdateFailed(function () {
            // 新版本下载失败
            wx.showModal({
              title: '已经有新版本喽~',
              content: '请您删除当前小程序，到微信 “发现-小程序” 页，重新搜索打开哦~',
              showCancel: false,
            })
          })
        }
      })
    } else {
      //此时微信版本太低（一般而言版本都是支持的）
      wx.showModal({
        title: '溫馨提示',
        content: '当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。',
        showCancel: false,
      })
    }
},
```

## 4. 小程序双线程架构

为了安全和管控，小程序使用双线程执行：`视图线程`和`逻辑线程`。

- View 视图线程
- App Service 逻辑线程

渲染层的界面使用了 `WebView` 进行渲染，通过逻辑层代码去控制渲染哪些界面，如果一个小程序存在多个界面，则渲染层存在多个 `WebView` 线程；逻辑层采用一个单独的 `JsCore` 线程运行 `JS` 脚本，在这个环境下执行的都是有关小程序业务逻辑的代码。

![小程序架构](https://img-blog.csdnimg.cn/6fb57597e4bd4e99ba3f645e15046f0a.png)

根据微信小程序开发文档可以得知小程序在三端的运行环境场景：

- `iOS` ：小程序逻辑层的 JavaScript 代码运行在 `JavaScriptCore()` 中，视图层是由 `WKWebView` 来渲染的
- `Android`：小程序逻辑层的 JavaScript 代码运行在 V8 中，视图层是由自研 XWeb 引擎基于 `Mobile（ ）Chrome()` 内核来渲染的
- `开发工具`：小程序逻辑层的 JavaScript 代码是运行在 `NW.js` 中，视图层是由 `Chromium() Webview` 来渲染的。

native 侧将 WeixinJSBridge 相关的方法注入到视图层和逻辑层。

**把开发者的 JS 逻辑代码放到单独的线程去运行，但在 Webview 线程里，开发者就没法直接操作 DOM。那要怎么去实现动态更改界面呢？**

1. 在渲染层把 WXML 转化成对应的 JS 对象。
2. 在逻辑层发生数据变更的时候，通过宿主环境提供的 setData 方法把数据从逻辑层传递到 Native，再转发到渲染层。
3. 经过对比前后差异，把差异应用在原来的 DOM 树上，更新界面。

## 5. 微信开发者工具中的实现

开发者工具中没有 native 模块，主要是通过`websocket`来实现消息的相互转发。

1. on: 用来收集小程序开发者工具触发的事件回调
2. invoke：以 api 方式调用开发工具提供的基础能力
3. publish：用来向 Appservice 业务层发送消息
4. subscribe: 用来收集 Appservice 业务逻辑层触发的事件回调

## 6. 为什么要采用双线程这种技术方案呢？

一、业务诉求

在微信小程序架构设计之初就只有一个要求，要求要快，包括渲染要快，加载要快。当用户点开某个小程序时，我们期望体验到的是只有很短的加载时间，在一个短暂的过渡动画后就能看到小程序的主界面。

当下流行的 3 大主流渲染方式：

- Web 技术渲染。
- 原生技术渲染；
- 混合技术渲染，同时使用了 webview 和原生来渲染（下称 Hybrid 技术）；

微信小程序的宿主为微信，我们不可能用原生语言来写小程序，如果真这么做，那么小程序代码与微信代码一起编译，跟随微信发版，这种开发方式跟节奏必然是不对的。因此，我们需要向 Web 技术那样，有一份随时可更新的资源包放在云端，通过下载到本地，动态执行后即可渲染出界面。

但如果用纯 Web 技术来渲染小程序，在一些有复杂交互的页面上可能会面临一些性能问题，这是因为在 Web 技术中，UI 渲染跟 JavaScript 的脚本执行都在一个单线程中执行，这就容易导致一些逻辑任务抢占 UI 渲染的资源。

因此微信小程序选择了 Hybrid 技术，界面主要由成熟的 Web 技术渲染，辅之以大量的接口提供丰富的客户端原生能力。同时，每个小程序页面都是用不同的 WebView 去渲染，这样可以提供更好的交互体验，更贴近原生体验，也避免了单个 WebView 的任务过于繁重。

此外，界面渲染这一块微信定义了一套内置组件以统一体验，并且提供一些基础和通用的能力，进一步降低开发者的学习门槛。值得一提的是，内置组件有一部份较复杂组件是用客户端原生渲染的，以提供更好的性能。

微信小程序是以 webview 渲染为主，原生渲染为辅的混合渲染方式；

二、管控与安全

基于 Web 技术来渲染小程序是存在一些不可控因素和安全风险的。这是因为 Web 技术是非常开放灵活的，我们可以利用 JavaScript 脚本随意地跳转网页或者改变界面上的任意内容。

为了解决管控与安全问题，我们必须阻止开发者使用一些浏览器提供的，诸如跳转页面、操作 DOM、动态执行脚本的开放性接口。要完全避免 JavaScript 的灵活性以及浏览器接口的丰富性而带来的一些危险的接口，或者浏览器内核更新而新增的危险接口，小程序提供一个沙箱环境来运行开发者的 JavaScript 代码。

因此，小程序的沙箱环境不能有任何浏览器相关接口，只提供纯 JavaScript 的解释执行环境，那么像 HTML5 中的 ServiceWorker、WebWorker 特性就符合这样的条件，这两者都是启用另一线程来执行 JavaScript。但是考虑到小程序是一个多 WebView 的架构，每一个小程序页面都是不同的 WebView 渲染后显示的，在这个架构下不好去用某个 WebView 中的 ServiceWorker 去管理所有的小程序页面。

得益于客户端系统有 JavaScript 的解释引擎（在 iOS 下是用内置的 JavaScriptCore 框架，在安卓则是用腾讯 x5 内核提供的 JsCore 环境），我们可以创建一个单独的线程去执行 JavaScript，在这个环境下执行的都是有关小程序业务逻辑的代码，也就是我们前面一直提到的逻辑层。而界面渲染相关的任务全都在 WebView 线程里执行，通过逻辑层代码去控制渲染哪些界面，那么这一层当然就是所谓的渲染层。

## 7. 为什么会选择去做小程序的导向？

1. 小程序是一种轻应用，即开即用无需复杂的下载按照过程且兼具了热更新和跨平台 2 个优点。
2. 小程序有着成熟的生态，一方面是微信推出的产品，在可持续迭代上有技术保障，二是可以借助本生微信的生态及用户体量快速传播。
3. 开发周期短，用户体验上会比单纯的 H5 上体验更流程。
4. 增加分享渠道和曝光数量。

## 8. 如何做好技术选型?

我觉得做好技术选型的话主要包括以下 4 个方面：

1. 可控性
2. 稳定性
3. 适用性
4. 易用性

### 可控性

可控性是非常重要的一个指标。

选择这门技术的时候，一定要在碰到问题的时候能够有人能够兜底去解决，不能因为某项技术可能确实很新颖，但是没有做详细的了解就去盲目的使用，这个时候很容易造成业务 bug。

核心项目必须是采用稳定的版本，一些小项目可以去使用新的技术去实验。

### 稳定性

稳定性一方面是指这项技术本身有稳定的版本迭代，不会一天一个版本，版本又都是破坏性的更新。

另外相对应的社区需要活跃，针对各种场景有成熟的解决方案。

另外文档方面也要相应的齐全，避免两眼一抹黑的去猜测使用。

### 适用性

1 方面是业务适用性强，能够具有良好的兼容性以及可扩展能力。

2 是需要适合团队成员，需要考虑到目前内部的技术栈以及相应成员的能力长短板进行一个抉择。

### 易用性

相对来说这门技术的上手成本不高，通过一段时间的学习就能够快速上手。

比如早期的 Angular 学习曲线相对陡峭，没有 Vue 和 React 平缓，这也是需要考虑的一个原因。

## 9. 前端自动化测试

- 单测：用 jest 较多，以及 mocha+chai
- E2E 测：cypress、python + selenium

## 10.能介绍下直播 SDK 这个项目吗？

## 11. 你在项目中主要是怎么样的一个角色？

## 12. 你觉得这个项目做的最好的是什么？

1. 重构过程中解决了发现的几个历史问题，减少了业务出错的可能性。
2. 重构后落地了对应的业务文档，方便后期查阅以及他人上手。
3. 重构后优化了整体的系统架构，依赖基础 SDK 统一开发，在提升了开发效率的同时也减少了项目体积，保证了 UI 的统一性。
4. 上线后提供了平台统一的解决方案，方便后期的快速接入，满足了兄弟部门的业务诉求。
5. 过程中提供了一些业务侧的常用工具，方便后期在开发中能够快速的模拟一些真实场景，释放部分测试资源。

## 13. 为什么小程序不能频繁的 setData

小程序的视图层目前使用 WebView 作为渲染载体，而逻辑层是由独立的 JavascriptCore 作为运行环境。在架构上，WebView 和 JavascriptCore 都是独立的模块，并不具备数据直接共享的通道。当前，视图层和逻辑层的数据传输，实际上通过两边提供的 evaluateJavascript 所实现。即用户传输的数据，需要将其转换为字符串形式传递，同时把转换后的数据内容拼接成一份 JS 脚本，再通过执行 JS 脚本的形式传递到两边独立环境。

而 evaluateJavascript 的执行会受很多方面的影响，数据到达视图层并不是实时的。

1. 频繁的去 setData

Android 下用户在滑动时会感觉到卡顿，操作反馈延迟严重，因为 JS 线程一直在编译执行渲染，未能及时将用户操作事件传递到逻辑层，逻辑层亦无法及时将操作处理结果及时传递到视图层；

渲染有出现延时，由于 WebView 的 JS 线程一直处于忙碌状态，逻辑层到页面层的通信耗时上升，视图层收到的数据消息时距离发出时间已经过去了几百毫秒，渲染的结果并不实时；

2. 每次 setData 都传递大量新数据

由 setData 的底层实现可知，我们的数据传输实际是一次 evaluateJavascript 脚本过程，当数据量过大时会增加脚本的编译执行时间，占用 WebView JS 线程，

3. 后台态页面进行 setData

当页面进入后台态(用户不可见)，不应该继续去进行 setData，后台态页面的渲染用户是无法感受的，另外后台态页面去 setData 也会抢占前台页面的执行。

## 14. RPA 技术及其应用难点

### RPA 技术

RPA 技术是一项在人工智能和自动化技术的基础上，通过模拟人对软件界面的操作，实现与现有业务系统的交互而完成任务的技术，是一种使业务流程自动化的软件技术。

通过 RPA 技术可以预先设定流程来处理事务、操作数据、触发响应，以及与其他数字系统进行通信，因此 RPA 又被称为“流程机器人”或者“RPA 机器人”。

需要强调的是，RPA 机器人是计算机编程的软件，而非可行走、可沟通的机器人，是替代人来实施基于规则的高度重复性工作的程序。RPA 可创造数字员工，作为高强度工作劳动力的补充。

### RPA 技术应用难点

1. RPA 机器人在复杂业务场景中的应用问题

传统 RPA 机器人无法应对复杂业务场景和不规则业务数据，不适用于需要在主观认知的基础上加以判断的流程，应用场景有限。为解决上述问题，融合图像识别、自然语义处理、知识图谱、智能决策、机器学习、智能语音等人工智能技术，可扩展 RPA 机器人的非结构化数据处理能力，并可通过容器云部署，解决 RPA 和人工智能部署落地难、成本高、周期长的问题，加快人工智能技术在业务场景中的应用，实现业务流程端到端的决策自动化，提高 RPA 机器人对复杂业务场景的应对能力。

2. RPA 机器人的易用性问题

目前，大多数 RPA 应用都是针对单个业务流程，开发交付对应的 RPA 流程代码，并安装部署到业务终端上运行，还需要安装 RPA 专用软件和进行一系列系统配置，需要专业技术人员进行操作才能使用，对于业务人员来说易用性较差；RPA 机器人终端一般是业务人员的办公电脑、虚拟桌面等，运行环境复杂多样，存在部署成本高、环境干扰因素多、运行不稳定、排查问题难、可维护性较差等问题。这些问题也随着 RPA 部署的客户端规模增长而被逐渐放大，不利于 RPA 大规模推广应用。

为解决上述问题，可将 RPA 机器人服务化——RPA 即服务(RPAasaService,RaaS），即把业务流程颗粒化拆分成标准化可复用组件，采用松耦合的微服务架构向外发布 RPA 组件服务，通过不同服务组件的快速组装和重复利用，降低开发成本、提升开发效率，实现多样化、复杂化业务流程的自动化，提高企业快速响应外部形势变化的能力。

3. RPA 机器人治理问题

传统 RPA 机器人深度依赖业务流程和业务系统的特性，导致其难以集中部署，当机器人客户端数量达到成千上万个规模后，控制、管理分散部署的机器人成为大问题；大企业为了避免 RPA 厂商垄断以及符合信息系统安全规定等，一般要求 RPA 开发工具多平台并行，因此，统一管理不同技术栈实现的机器人成为现实问题；机器人开发交付流程还处于落后的“手工作坊式”阶段，如流程咨询、需求整理、开发交付等仍依靠手工记录和分析，交付全流程无法进行数字化管理；RPA 机器人的运行数据等不能自动采集、统计及统一展示，只能由人工完成，导致 RPA 机器人的应用价值很难评估。

为解决上述 RPA 机器人治理相关问题，可开发数字员工平台，实现机器人交付全流程数字化管理，统一管理多品类 RPA 机器人，自动统计及展示运营数据，有效协同不同功能机器人，串联管理各业务单位的数字员工，对运行情况统一记录、管理和调用，实现对数字员工的一体化管理。

## 15. 为什么需要 rpa

中国企业与机构的用人成本逐渐攀升，但人工作业的劳动力瓶颈却无法得到突破。因此多数企业与机构亟待通过数字化技术能力打破生产力瓶颈。针对企业中流程性固定、重复性频率高的业务，RPA 大有用武之地。

## 16. 为什么离职？

主要是因为个人职业规划以及公司组织架构调整。

一方面是之前公司现有的业务相对来说已经比较稳定了，项目本身上存在的挑战性较少，可以获得的收获也相对较少了。

另一方面也考虑到一个赛道的问题，相对来说现阶段电商相关的一些业务也受疫情影响比较大，很多业务存在消耗存量的情况，新业务的发展比较受限。

刚好这个时期电商平台最忙的双 11 活动过去了，年底相对来说没有那么繁忙。这个时候又迎来了内部的组织架构调整，这个时期选择离开的话还能获得一部分的赔偿。

也是因为在这个契机下选择了离开，想去一些新的赛道试试机会。

一方面能够接触一些新的知识，提高自己的眼界，另一方面也能

## 17. 如何筛选核心成员

1. 标准敢于承担，能主动做事
2.
