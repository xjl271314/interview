---
title: 飞猪前端面试
nav:
  title: 模拟试题
  path: /demos
  order: 0
group:
  title: 技术部分
  path: /demos/technology
---

# 飞猪前端面试

## 自我介绍

面试官你好，我叫许将龙，今年 28 岁，浙江台州人，计算机相关专业毕业，目前从事前端相关的工作已经有 6 年时间了。

自工作以来，主要深耕于 PC、H5、公众号、小程序、Hybrid 等方向，业务范围主要囊括了电商、金融、直播、拍卖行等场景，技术栈方面个人擅长 React 相关的一些技术栈。

之前担任公司业务线内前端团队的 Leader，负责主站核心业务--直播和拍卖行相关的业务开发、团队资源统筹、项目管理以及成员带教相关的工作。期间也带领团队完成了多次核心业务指标贡献，辅导了 4 位成员的转正和晋升工作，自己也收获了内部的多项荣誉。

此外我也是一个擅长总结和归纳的人，除了定期在团队内外组件技术分享外，闲暇的时间我也沉淀了上百篇的技术博客。

最后，我是一个外向、乐观、自律的人，擅长与人沟通，学习能力强，能够快速的融入到团队中来。

以上便是我的个人简介部分，谢谢。

## 最近比较成功的项目？

我最近做的一个项目是直播 SDK，功能上包括了基础播放器、拉流播放器、IM 聊天系统以及弹幕等基础功能模块和一些其他的业务模块。人员上涉及了四个端，其中我主要负责了 H5 和小程序相关的功能开发并担任了部分模块的项目负责人。技术栈上主要是 React 和原生的微信小程序。其中播放器相关的能力在 H5 侧基于 videojs 和 B 站的 flv 来实现，小程序侧主要依赖原生的 live-player 组件。IM 聊天系统则是借助了 websocket 和腾讯云 IM 来实现的。整体大概花了 8 个月的时间完成了 SDK 的开发和全量上线工作。提供了平台级的直播解决方案，为其他业务团队提供了快速接入的能力。

## 详细展开说说？

当时做这个项目的业务背景大致有以下 6 点。

1. 历史业务都没有相对应的文档，导致在做业务决策的时候存在一定困扰。
2. 历史代码目录结构混乱，业务耦合度高。影响业务开发周期也容易造成隐患。
3. 迭代中出现过由于业务层层级导致交互异常的问题。
4. 当时我们业务主要是 4 个端，各端在播放器一些异常处理和 UI 表现上不一致。
5. 无法快速移植，除了业务线外也有其他兄弟部门的业务诉求，比如当时做一个达人直播的新项目的时候也需要依赖直播的一些基础能力。
6. 公司侧本身在做一个全平台的链路优化，包括统一基础组件风格，抽象基础业务模块等。

基于以上的 6 个痛点，在业务线内经过长期的讨论和规划之后发起了直播 SDK 这个技术型迭代。

前期我们跟多条线的产品和业务方进行了详细的沟通，了解了不同业务上的一些诉求，讨论后在功能模块上主要拟定了以下 5 大基础模块，包括：

1. 基础的视频播放器，用于支持全平台视频播放相关的一些业务
2. 直播拉流播放器用于所有直播场景的视频播放。
3. 直播间弹幕体系，包括公告，入场弹幕以及自定义弹幕等。
4. 直播间 IM 模块，用于接收和处理各类直播间内的 IM 消息。
5. 直播间联麦功能模块，用于主播与主播，主播与用户之间的联麦功能。

在确认了这 5 大基础模块后，我们先做了一个核心成员的选定工作。

主要是通过平时的工作情况以及组内的横向对比，结合该人员的层级筛选出各个模块的核心开发者以及对应的项目负责人。

筛选完成员之后，讨论了具体的技术实现方案，并通过思维导图的模式确认了每个模块详细功能点，制定了相应的项目排期。

在定好项目的开发周期后，通过表格的形式记录到小组内部的资源占用表中，并将相应的开发成员拉入到项目群内，同时将技术方案，时间节点以及每个人的分工详细的记录到群公告中。

在项目进行的过程中，我们会在关键的时间节点进行一个 check。比如通过站立会来同步每个端的项目进度也会在周五的周会上再次同步。

在开发完成后，组织了组内的代码初步 review 工作，确保业务的没有遗漏，实现上是不是统一的，没有明显的错误。

在提测之前，要求每个端都做好自测工作，保证提测的代码质量。

在上线前，做好 CodeReview 并确认好各个端的发布顺序，做好项目上线前最后一道保障。

最终历时了 8 个月左右的时间完成了整体 SDK 的开发以及全量的替换工作。上线后也在公司内部举行了大型的技术分享会，邀请了各个兄弟部门来参加，同步相关的技术方案和使用指南。

## 当初做这个项目的时候你是如何去做技术选型的？

首先是在各个端做了一个内部的技术调研，主要确认各端在其他业务团队的相关技术栈，降低上手成本。

在框架选择上，我们当时内部在推一个多端组件库，基本上各个业务场景都要使用到这个组件库。

因此最初考虑是将 H5 和小程序的直播 SDK 都集成到这个多端组件库内。

一是方便插件包的管理，不需要通过额外的 npm 包进行管理。
二是能做到开箱即用，其他团队使用的时候，只需要在这个包内去引入相关的功能模块就可以了。

后来做了一些技术型的调研，发现小程序侧直播功能是需要依赖于原生组件，且又依赖了一个老的小程序插件。无法使用多端的方式去统一实现，因此在得到这个调研结果的同时也第一时间向 PM 以及我的领导进行了反馈，确认了该技术方案的变动，并梳理了相对的开发周期成本。

因此在后期的包管理上，直播播放器的能力由小程序端单独去实现，而其他可以多端实现的模块采用多端的方式去构建。

另外在具体的技术选型上，查阅了相关的社区已有一些解决方案结合 H5 平台的传播特性以及兼容性问题，H5 播放器这块主要是基于 Videojs 实现了一个通用 HLS 流播放器，在 PC 和安卓设备上借助了 B 站的 flv.js 来支持部分 flv 格式流的播放。

## 为什么选用 remax 这个框架？

1. public 目录里的原生代码会拷贝到 dist 目录并且 pages 目录会合并，我们可以利用这一机制最大程度的复用现有小程序的代码，这也是我们团队选择 Remax 这个框架的原因之一。

2. 技术栈为 React

3. 由于 Remax 实现原理的限制，在小程序上较复杂的页面性能上会有不足。当然这也是所有跨端框架存在的问题，好在可以通过使用自定原生组件的方式来解决。

## 你负责的功能模块包含哪些？你担任了什么角色？

其中我负责了所有功能模块的开发以及直播 IM 和直播弹幕组件的设计和统筹工作。

在做直播 IM 系统的时候，当时也找我的领导进行了一些沟通，主要讨论了相应的业务场景。当时公司内部也有相应的一套 socket 系统，用于支撑一些消息相关的业务。结合直播业务的特殊性，部分功能是依赖腾讯的一些服务。因此对使用群体做了一部分的区分，比如针对一些未登录用户主要以内部的场景为主，这个时候可以使用内部的这套系统，节省相应的一些服务成本。对于外部的用户群体沿用原有的腾讯的服务，避免过大的改动造成一些不可控的问题。

在做弹幕组件设计的时候，因为当时我们的业务方有多个，也跟多个产品进行了沟通，总结了不同业务上一些相同以及特殊的业务需求。然后根据这些需求进行了模型的抽象，提炼出了包含入场、发言、出价、中拍、排队等多个场景，在场景的基础上做了 schema 的设计，比如头像、用户身份、用户等级等自定义字段，通过后端返回的形式在前端自定义进行组装。避免了每次新业务都需要重新去开发、发版的问题。
同时，我主动联合后端用 python 写了一个自动 IM 测试的脚本，极大的提高了整体的一个开发和测试效率。

## 在业务的迭代过程中有碰到什么困难？你是如何去解决的？

主要碰到了一些历史问题以及兼容性和资源协调上的一些问题。

1. 部分业务侧层级混乱。

   在播放器的开发过程中，由于涉及到一些异常状态处理，比如说暂停、断网、流拉取异常、副流切换等场景发现部分业务侧的组件 z-index 异常，部分操作会影响。

   当时在发现这个问题的时候，首先第一时间在项目群进行了同步，通知了其他端的开发者以及产品，并确认了业务的正确层级。

   其次在内部进行了讨论，制定了统一的 z-index 规范，比如播放器 z 值为 0，封面图 z 值为 1，其他一些正常的业务组件 z 值为 5，一级弹窗为 10 等。

   严格按照这套标准去分层，并把相对应的改动点同步给了测试。

   最终上线后没有出现过因为层级导致的一些 bug。

2. 播放器在不同端的兼容性问题。

   例如 H5 侧在 Chrome 等浏览器上无法自动播放，通过修改网站设置--声音来支持，其他浏览器尝试进行自动播放，失败的话进行兜底 UI 展示。

   在 ios 设备上不兼容 flv 格式的流，技术上优先检测是否支持 flv，不支持的情况下采用 hls 进行兜底。业务上公众号内部导向小程序直播间，App 内嵌页面采用同层渲染的模式。

   ios 和安卓上播放器层级最高，通过设置`playsinline`以及`x5-video-player-type="h5-page"`来解决播放器层级问题。

   播放器布局问题，通过设置`x5-video-orientation="portraint"`启用竖屏模式。

   播放器没有全屏，通过设置`object-fit: fill` 让视频内容充满整个 video 容器。

3. 做弹幕体系的时候存在测试资源紧张的问题。

   当时的情况是这样的，本身线上的一些业务场景在测试环境不好复现，需要走的流程比较长，也需要占用较多的测试资源。

   因此需要一个工具能够帮助开发进行自行模拟相关的一些业务场景，尽量在开发阶段就覆盖到全场景，避免在测试阶段暴露出来过多的问题，尽量做好前置的一个质量把关工作。

   得益于之前在做业务迭代的同时，我已经将 H5 侧所有的 IM 场景进行了梳理并落地了对应的文档。在基于这个文档的基础上主动联合后端提供了一个后端侧的 API，另外由于我自己学过 python 相关的一些知识，利用 python 做了一个自动转发的小工具，提供给了其他端和测试使用。

   这样在开发阶段基本上就覆盖了所有的场景，并且释放了大量的测试资源，因为之前很多时候都是需要测试配合。

   后来也将这块功能集成到了内部的 QA 系统中，形成了业务线内的常用工具。
